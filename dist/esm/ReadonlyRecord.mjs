import{fromEquals as e}from"./Eq.mjs";import{SK as t,flow as r,identity as n,pipe as i}from"./function.mjs";import{flap as l}from"./Functor.mjs";import{has as u,isLeft as a,isNone as o,isSome as f,none as c,some as d}from"./internal.mjs";import{separated as p}from"./Separated.mjs";import{Ord as h}from"./string.mjs";import{wiltDefault as s,witherDefault as m}from"./Witherable.mjs";let g=e=>Object.assign({},e),W=e=>Object.assign({},e),I=e=>Object.keys(e).length,x=e=>{for(let t in e)if(u.call(e,t))return!1;return!0},M=e=>t=>Object.keys(t).sort(e.compare),R=M(h);function b(e){if("function"==typeof e)return b(h)(e);let t=M(e);return e=>r=>{let n=[];for(let i of t(r))n.push(e(i,r[i]));return n}}let v=b(h)((e,t)=>[e,t]);function _(e){return t=>{let r=v(t),n=r.length;return e.unfold(0,e=>e<n?d([r[e],e+1]):c)}}let y=(e,t)=>r=>{if(u.call(r,e)&&r[e]===t)return r;let n=Object.assign({},r);return n[e]=t,n},j=(e,t)=>u.call(t,e);function w(e){return t=>{if(!u.call(t,e))return t;let r=Object.assign({},t);return delete r[e],r}}let O=(e,t)=>r=>{if(!j(e,r))return c;if(r[e]===t)return d(r);let n=Object.assign({},r);return n[e]=t,d(n)},F=(e,t)=>r=>{if(!j(e,r))return c;let n=t(r[e]);if(n===r[e])return d(r);let i=Object.assign({},r);return i[e]=n,d(i)};function q(e){let t=w(e);return r=>{let n=S(e,r);return o(n)?c:d([n.value,t(r)])}}function A(e){return(t,r)=>{if(void 0===r){let r=A(e);return e=>r(e,t)}for(let n in t)if(!u.call(r,n)||!e.equals(t[n],r[n]))return!1;return!0}}function S(e,t){return void 0===t?t=>S(e,t):u.call(t,e)?d(t[e]):c}let k={};function E(e){return t=>{let r={};for(let n in t)u.call(t,n)&&(r[n]=e(n,t[n]));return r}}function T(e){return E((t,r)=>e(r))}function U(...e){if(2===e.length)return U(h)(...e);let t=M(e[0]);return(e,r)=>n=>{let i=e,l=t(n),u=l.length;for(let e=0;e<u;e++){let t=l[e];i=r(t,i,n[t])}return i}}function $(e){if("compare"in e){let t=M(e);return e=>r=>n=>{let i=e.empty,l=t(n),u=l.length;for(let t=0;t<u;t++){let u=l[t];i=e.concat(i,r(u,n[u]))}return i}}return $(h)(e)}function P(...e){if(2===e.length)return P(h)(...e);let t=M(e[0]);return(e,r)=>n=>{let i=e,l=t(n),u=l.length;for(let e=u-1;e>=0;e--){let t=l[e];i=r(t,n[t],i)}return i}}let z=(e,t)=>({[e]:t});function C(e){let t=ev(h)(e);return e=>r=>t(r,e)}function D(e){let t=eR(h)(e);return e=>r=>t(r,e)}function J(e){return eb(h)(e)}let L=e=>{let t=D(e);return r=>n=>e.map(i(n,t(r)),eA)},N=e=>{let t=D(e);return r=>n=>e.map(i(n,t(r)),eS)};function B(e){return t=>{let r={},n={};for(let i in t)if(u.call(t,i)){let l=e(i,t[i]);switch(l._tag){case"Left":r[i]=l.left;break;case"Right":n[i]=l.right}}return p(r,n)}}function G(e){return t=>{let r={},n={};for(let i in t)if(u.call(t,i)){let l=t[i];e(i,l)?n[i]=l:r[i]=l}return p(r,n)}}function H(e){return t=>{let r={};for(let n in t)if(u.call(t,n)){let i=e(n,t[n]);f(i)&&(r[n]=i.value)}return r}}function K(e){return t=>{let r={},n=!1;for(let i in t)if(u.call(t,i)){let l=t[i];e(i,l)?r[i]=l:n=!0}return n?r:t}}function Q(e,t){let r=V(e,t);return e=>r(e,n)}function V(e,t){return(r,n)=>t.reduce(r,{},(t,r)=>{let[i,l]=n(r);return t[i]=u.call(t,i)?e.concat(t[i],l):l,t})}let X=v,Y=e=>{let t={};for(let r of e)t[r[0]]=r[1];return t};function Z(e){return t=>{for(let r in t)if(!e(t[r]))return!1;return!0}}function ee(e){return t=>{for(let r in t)if(e(t[r]))return!0;return!1}}function et(e){return(t,r)=>{if(void 0===r){let r=et(e);return e=>r(t,e)}for(let n in r)if(e.equals(r[n],t))return!0;return!1}}let er=e=>t=>r=>{if(x(r))return t;if(x(t))return r;let n={};for(let i in r)j(i,t)?n[i]=e.concat(r[i],t[i]):n[i]=r[i];for(let e in t)j(e,n)||(n[e]=t[e]);return n},en=e=>t=>r=>{if(x(r)||x(t))return k;let n={};for(let i in r)j(i,t)&&(n[i]=e.concat(r[i],t[i]));return n},ei=e=>t=>{if(x(t))return e;if(x(e))return t;let r={};for(let n in t)j(n,e)||(r[n]=t[n]);for(let n in e)j(n,t)||(r[n]=e[n]);return r},el=(e,t)=>i(e,T(t)),eu=(e,t)=>i(e,E(t)),ea=e=>{let t=eO(e);return(e,r,n)=>i(e,t(r,n))},eo=e=>t=>{let r=eF(e)(t);return(e,t)=>i(e,r(t))},ef=e=>{let t=eq(e);return(e,r,n)=>i(e,t(r,n))},ec=(e,t)=>i(e,e_(t)),ed=(e,t)=>i(e,ey(t)),ep=(e,t)=>i(e,ej(t)),eh=(e,t)=>i(e,ew(t)),es=e=>{let t=U(e);return(e,r,n)=>i(e,t(r,n))},em=e=>{let t=$(e);return e=>{let r=t(e);return(e,t)=>i(e,r(t))}},eg=e=>{let t=P(e);return(e,r,n)=>i(e,t(r,n))},eW=(e,t)=>i(e,B(t)),eI=(e,t)=>i(e,G(t)),ex=(e,t)=>i(e,H(t)),eM=(e,t)=>i(e,K(t)),eR=e=>{let n=ev(e);return e=>{let i=n(e);return(e,n)=>i(e,r(t,n))}},eb=e=>{let t=eR(e);return e=>{let r=t(e);return e=>r(e,n)}},ev=e=>t=>{let r=M(e);return(e,n)=>{let i=r(e);if(0===i.length)return t.of(k);let l=t.of({});for(let r of i)l=t.ap(t.map(l,e=>t=>Object.assign({},e,{[r]:t})),n(r,e[r]));return l}},e_=e=>K((t,r)=>e(r)),ey=e=>H((t,r)=>e(r)),ej=e=>G((t,r)=>e(r)),ew=e=>B((t,r)=>e(r));function eO(...e){if(1===e.length){let t=U(e[0]);return(e,r)=>t(e,(e,t,n)=>r(t,n))}return eO(h)(...e)}function eF(e){if("compare"in e){let t=$(e);return e=>{let r=t(e);return e=>r((t,r)=>e(r))}}return eF(h)(e)}function eq(...e){if(1===e.length){let t=P(e[0]);return(e,r)=>t(e,(e,t,n)=>r(t,n))}return eq(h)(...e)}let eA=e=>{let t={};for(let r in e)if(u.call(e,r)){let n=e[r];f(n)&&(t[r]=n.value)}return t},eS=e=>{let t={},r={};for(let n in e)if(u.call(e,n)){let i=e[n];a(i)?t[n]=i.left:r[n]=i.right}return p(t,r)},ek="ReadonlyRecord";function eE(e){return"compare"in e?t=>({show:r=>{let n=b(e)((e,r)=>`${JSON.stringify(e)}: ${t.show(r)}`)(r).join(", ");return""===n?"{}":`{ ${n} }`}}):eE(h)(e)}function eT(t){let r=A(t);return e((e,t)=>r(e)(t)&&r(t)(e))}function eU(e){return{concat:(t,r)=>{if(x(t))return r;if(x(r))return t;let n=Object.assign({},t);for(let i in r)u.call(r,i)&&(n[i]=u.call(t,i)?e.concat(t[i],r[i]):r[i]);return n},empty:k}}let e$={URI:ek,map:el},eP=l(e$),ez={URI:ek,map:el,mapWithIndex:eu},eC=e=>({URI:ek,reduce:ea(e),foldMap:eo(e),reduceRight:ef(e)}),eD=e=>({URI:ek,reduce:ea(e),foldMap:eo(e),reduceRight:ef(e),reduceWithIndex:es(e),foldMapWithIndex:em(e),reduceRightWithIndex:eg(e)}),eJ={URI:ek,compact:eA,separate:eS},eL={URI:ek,map:el,compact:eA,separate:eS,filter:ec,filterMap:ed,partition:ep,partitionMap:eh},eN={URI:ek,map:el,mapWithIndex:eu,compact:eA,separate:eS,filter:ec,filterMap:ed,partition:ep,partitionMap:eh,filterMapWithIndex:ex,filterWithIndex:eM,partitionMapWithIndex:eW,partitionWithIndex:eI},eB=e=>({URI:ek,map:el,reduce:ea(e),foldMap:eo(e),reduceRight:ef(e),traverse:eR(e),sequence:eb(e)}),eG=e=>({URI:ek,map:el,mapWithIndex:eu,reduce:ea(e),foldMap:eo(e),reduceRight:ef(e),reduceWithIndex:es(e),foldMapWithIndex:em(e),reduceRightWithIndex:eg(e),traverse:eR(e),sequence:eb(e),traverseWithIndex:ev(e)}),eH=e=>{let t=eB(e);return{URI:ek,map:el,reduce:ea(e),foldMap:eo(e),reduceRight:ef(e),traverse:t.traverse,sequence:t.sequence,compact:eA,separate:eS,filter:ec,filterMap:ed,partition:ep,partitionMap:eh,wither:m(t,eJ),wilt:s(t,eJ)}},eK=e=>{let t=er(e);return{concat:(e,r)=>t(r)(e)}},eQ=e=>({concat:eK(e).concat,empty:k}),eV=e=>{let t=en(e);return{concat:(e,r)=>t(r)(e)}},eX=()=>({concat:(e,t)=>ei(t)(e)}),eY={URI:ek,reduce:ea(h),foldMap:eo(h),reduceRight:ef(h)},eZ={URI:ek,reduce:ea(h),foldMap:eo(h),reduceRight:ef(h),reduceWithIndex:es(h),foldMapWithIndex:em(h),reduceRightWithIndex:eg(h)},e0={URI:ek,map:el,reduce:ea(h),foldMap:eo(h),reduceRight:ef(h),traverse:eR(h),sequence:J},e1={URI:ek,map:el,mapWithIndex:eu,reduce:ea(h),foldMap:eo(h),reduceRight:ef(h),reduceWithIndex:es(h),foldMapWithIndex:em(h),reduceRightWithIndex:eg(h),traverse:eR(h),sequence:J,traverseWithIndex:ev(h)},e2=m(e0,eJ),e3=s(e0,eJ),e4={URI:ek,map:el,reduce:ea(h),foldMap:eo(h),reduceRight:ef(h),traverse:eR(h),sequence:J,compact:eA,separate:eS,filter:ec,filterMap:ed,partition:ep,partitionMap:eh,wither:e2,wilt:e3},e5=y;function e6(e,t){return u.call(void 0===t?this:t,e)}let e7={URI:ek,map:el,reduce:ea(h),foldMap:eo(h),reduceRight:ef(h),traverse:eR(h),sequence:J,compact:eA,separate:eS,filter:ec,filterMap:ed,partition:ep,partitionMap:eh,mapWithIndex:eu,reduceWithIndex:es(h),foldMapWithIndex:em(h),reduceRightWithIndex:eg(h),filterMapWithIndex:ex,filterWithIndex:eM,partitionMapWithIndex:eW,partitionWithIndex:eI,traverseWithIndex:ev(h),wither:e2,wilt:e3};export{eJ as Compactable,eL as Filterable,eN as FilterableWithIndex,eY as Foldable,eZ as FoldableWithIndex,e$ as Functor,ez as FunctorWithIndex,e0 as Traversable,e1 as TraversableWithIndex,ek as URI,e4 as Witherable,ec as _filter,ed as _filterMap,ex as _filterMapWithIndex,eM as _filterWithIndex,eo as _foldMap,em as _foldMapWithIndex,el as _map,eu as _mapWithIndex,ep as _partition,eh as _partitionMap,eW as _partitionMapWithIndex,eI as _partitionWithIndex,ea as _reduce,ef as _reduceRight,eg as _reduceRightWithIndex,es as _reduceWithIndex,eb as _sequence,eR as _traverse,b as collect,eA as compact,w as deleteAt,ei as difference,et as elem,k as empty,Z as every,e_ as filter,ey as filterMap,H as filterMapWithIndex,K as filterWithIndex,eP as flap,eF as foldMap,$ as foldMapWithIndex,Y as fromEntries,Q as fromFoldable,V as fromFoldableMap,g as fromRecord,eX as getDifferenceMagma,eT as getEq,eC as getFoldable,eD as getFoldableWithIndex,eV as getIntersectionSemigroup,eU as getMonoid,eE as getShow,eB as getTraversable,eG as getTraversableWithIndex,eQ as getUnionMonoid,eK as getUnionSemigroup,eH as getWitherable,j as has,e6 as hasOwnProperty,e5 as insertAt,en as intersection,x as isEmpty,A as isSubrecord,R as keys,S as lookup,T as map,E as mapWithIndex,F as modifyAt,ej as partition,ew as partitionMap,B as partitionMapWithIndex,G as partitionWithIndex,q as pop,e7 as readonlyRecord,eO as reduce,eq as reduceRight,P as reduceRightWithIndex,U as reduceWithIndex,eS as separate,J as sequence,z as singleton,I as size,ee as some,X as toEntries,v as toReadonlyArray,W as toRecord,_ as toUnfoldable,D as traverse,C as traverseWithIndex,er as union,O as updateAt,y as upsertAt,N as wilt,L as wither};